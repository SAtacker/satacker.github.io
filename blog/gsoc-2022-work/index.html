<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">GSoC 2022 Report | Shreyas Atre</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://satacker.github.io/blog/gsoc-2022-work"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="GSoC 2022 Report | Shreyas Atre"><meta data-rh="true" name="description" content="1. GSoC 2022 Report"><meta data-rh="true" property="og:description" content="1. GSoC 2022 Report"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-01-13T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/SAtacker"><meta data-rh="true" property="article:tag" content="GSoC,C++,HPX"><link data-rh="true" rel="icon" href="https://avatars.githubusercontent.com/u/61797109?v=4"><link data-rh="true" rel="canonical" href="https://satacker.github.io/blog/gsoc-2022-work"><link data-rh="true" rel="alternate" href="https://satacker.github.io/blog/gsoc-2022-work" hreflang="en"><link data-rh="true" rel="alternate" href="https://satacker.github.io/blog/gsoc-2022-work" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Shreyas Atre RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Shreyas Atre Atom Feed"><link rel="stylesheet" href="/assets/css/styles.bf8a9181.css">
<link rel="preload" href="/assets/js/runtime~main.2a141806.js" as="script">
<link rel="preload" href="/assets/js/main.4858563c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="https://avatars.githubusercontent.com/u/61797109?v=4" alt="Home" class="themedImage_ToTc themedImage--light_HNdA"><img src="https://avatars.githubusercontent.com/u/61797109?v=4" alt="Home" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Home</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/gsoc-log">GSoC Log</a><a class="navbar__item navbar__link" href="/resume">Resume</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/SAtacker" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/basic_source_resources">Open Source Resources</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/basic-coa">Review of basic CoA</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/gsoc-2022-work">GSoC 2022 Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/dbus-crossc">DBus Cross-compilation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/hello-world">Hello</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">GSoC 2022 Report</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-01-13T00:00:00.000Z" itemprop="datePublished">January 13, 2022</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/SAtacker" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/SAtacker.png" alt="Shreyas Atre"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/SAtacker" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Shreyas Atre</span></a></div><small class="avatar__subtitle" itemprop="description">RI at STE||AR Group (Louisiana State University), Maintainer of WasmEdge PySDK &amp; Install Script</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-gsoc-2022-report">1. GSoC 2022 Report<a class="hash-link" href="#1-gsoc-2022-report" title="Direct link to heading">​</a></h2><div align="center"><img loading="lazy" height="70%" width="70%" src="https://developers.google.com/open-source/gsoc/resources/downloads/GSoC-Horizontal.png" alt="GSoC @ HPX, STE||AR Group banner" class="img_ev3q"><img loading="lazy" src="https://raw.githubusercontent.com/STEllAR-GROUP/hpx/master/docs/sphinx/_static/images/HPX_STELLAR.png" alt="GSoC @ HPX, STE||AR Group banner" class="img_ev3q"></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-about-the-project">2. About the project<a class="hash-link" href="#2-about-the-project" title="Direct link to heading">​</a></h2><p><a href="https://summerofcode.withgoogle.com/programs/2022/projects/YXhhTBJw" target="_blank" rel="noopener noreferrer">GSoC Project Acceptance Page</a></p><p>Mentors</p><ul><li>Dr. Hartmut Kaiser</li><li>Giannis Gonidelis</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-objective">3. Objective<a class="hash-link" href="#3-objective" title="Direct link to heading">​</a></h2><p>The main objective of this project was to enable the usage of co_await or to simplify - enable the usage of coroutines with the latest specs of Senders and receivers.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-abstract">4. Abstract<a class="hash-link" href="#4-abstract" title="Direct link to heading">​</a></h2><p>HPX being up to date with Std C++ Proposals, Senders/Receivers were implemented as per P2300. But they have been missing coroutine (co_await) integration and minor functionalities as described in P2300 which is likely to be accepted. Hence I plan to implement these functionalities within the Core HPX Library. </p><ul><li>Benefits: <ul><li>Coroutines introduce better async code. For example, it is more readable, local variables have the same lifespan as the coroutine which means we don’t need to worry about allocation/release. </li><li>S/R algorithms can work with coroutines which they cannot as of now unless relied on futures which as mentioned are single-time use. </li><li>Adding co_await support makes the code more structured with respect to concurrency which can also be done by library abstractions of callbacks but using co_await may make it more optimized.</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-brief-summary">5. Brief Summary<a class="hash-link" href="#5-brief-summary" title="Direct link to heading">​</a></h2><ul><li><p>Senders, and Receivers</p><ul><li>Because it makes a more consistent programming model considering async programming types i.e. Parallelism and Concurrency. It standardizes the terminologies and execution policies which are more generic and reduce redundancy.</li><li>Coroutines have a direct connection between Senders and Coroutine Awaitables.</li><li>If you are familiar with Eric&#x27;s <a href="https://www.youtube.com/watch?v=xiaqNvqRB2E" target="_blank" rel="noopener noreferrer">talk on live senders/receivers</a>, you might be comfortable watching <a href="https://viewer.diagrams.net/?tags=%7B%7D&amp;highlight=000000&amp;edit=_blank&amp;layers=1&amp;nav=1&amp;page-id=N1fN19OSE8Ezd9pb87vr&amp;title=sender_receiver#R%3Cmxfile%3E%3Cdiagram%20id%3D%22EqYSzL36J7Lu1Ck5oe2v%22%20name%3D%22Page-1%22%3E5VrBcps6FP0az7SLZpAEGC8TN2kX7XttPXkvXSogA42MPEKuTb%2B%2BIohgIeLSsY1os7HRRULi3HOuriQmaL7aveN4nXxkEaET6ES7CXo7gRAgN5B%2FpaWoLIGDKkPM00hVagyL9AdRRkdZN2lEcq2iYIyKdK0bQ5ZlJBSaDXPOtnq1JaN6r2scE8OwCDE1rf%2BnkUjUW8BpY39P0jipewb%2BrLqzwnVl9SZ5giO23TOh6wmac8ZEdbXazQktwatxqdrdPHP3aWCcZKJPgyW6W37%2BTxBSxPz%2B07dbim9v3nhqbKKoX5hE8v1VkXGRsJhlmF431ivONllEyqc6stTU%2BcDYWhqBNH4jQhTKmXgjmDQlYkXVXTlgXtyV7S%2B8uvhVPe6x8HanlQpVqsZaDvBZCJQpZxsekgPvXVMJ85iIA%2FXgk6MkwwlbETke2Y4TikX6XR8HVlSLn%2Bo13pAXyiG%2F4Rz13O%2BYblRPizAh0YYSfpGrq1evDQ82%2FinB3iapIIs1foRjK0Wq%2B0J1Qbggu8OomiioBshXYlASB55i%2FLYRDKhVkOyJxXfOBZxrldZAI3XD8fPTGvakNbDKa2jymkjouX0me67GZDjrYLLrm0wOzsXkWjZ7WNmg9gkpivpSdGaTosiA%2Fd814bJjlknzQmBBrLMVOo7GVreLrYPGXddA7QsJiXSWlLZPZe9X9%2BVVXF69mrNMpNlGYXozx5Te4%2FDhtVnVOtJAB7ozLHgdQJ8tLNQDGniC26Xibu96b3qTpWZ2Kwv15NbketYmRb9nxLEacHxDOpd5kYVlVzRmPBXJyroMkKvrYGo90QusyMA%2Bpac9Ke3bpPTUoPRI0jwwGxuPZ2OFynPGBhWwu2Vhb20H%2Bi7uXJuiB74N99iAGR0Js2r6iaVyiE1S77eS%2BraQqnGpVi1nPQ3jCP%2BZi%2FO52lpt%2B1VGFaG7IRecPZA5o4xLS8ay0rnLlNKWCdM0zmQxlN6RQQ5dlTEqDTG9VDdWaRQ9MqMrwulsOUGQg0jHHNUxZi%2FI%2BR0xDp1t1Q8MsF9GXgNmPcUHj93A6laf35ruPDiw%2BsxEIC%2F3Gi7kLxcde72%2FyAD0dOEEUnFHt%2BcArUw4I8gHYN%2BJCnqn0Mol57jYq7AuNZAfkFKgM8V3vZavqyeeVD81Js%2Fs24VstaZEkHyEe0w%2BHJ2ypnZnIf1wEAyoLK%2Bnsqxm2vUo97j%2BDxPpsvh7E7X2BpSPTI0MmqghM97Y0MwJuV9D9evlzzOuGuh8xjxqeDHAH7vwPA5480DyhrPHiZ9kkfVZtL21FwS2Z1F04CuO3MBr6Hy%2BlaQBpyOiDoyXefRa7YXaBwvO3NGhZW6y%2F%2BlxsG%2FyhawebiBzpf5igA9sAu8iGziPYL3f3z%2BOTf8gc1lyhcOHN2PIDtqnWSPIDsxz%2F%2FqTGfvzXRsu4EDreAUGXsaHWfaB8%2F0BgZuUCXj9EXm1kdZ8io%2BufwI%3D%3C%2Fdiagram%3E%3Cdiagram%20id%3D%22RS2BbCfXYksCsHZpGadt%22%20name%3D%22Page-2%22%3E7VhNc5swEP01PqYDyGD72Nhpk2nSTutDnVNHhQ2oFYgRcozz67sYYcAysTPj2G7aE%2BzTB9J7b1caemQc5x8lTaM7EQDvOVaQ98ik5zg26Q%2FxUSDLEhlapARCyQLdqQam7Ak0aGl0zgLIWh2VEFyxtA36IknAVy2MSikW7W4Pgre%2FmtIQDGDqU26i31mgIr0LZ1Dj18DCqPqy7Y3KlphWnfVOsogGYtGAyFWPjKUQqnyL8zHwgryKl3Lch47W9cIkJGqfAfkduRGzTzfX4j69AAifbr8GF55em1pWG4YA969DIVUkQpFQflWjl1LMkwCKWS2M6j63QqQI2gj%2BAqWWWkw6VwKhSMVct%2BKC5XKmx6%2BC%2ByJ451bhJG82TpY6KtdaLLCTAg1lYi59eGbflZWoDEE9089dC4UOBxEDrgfHSeBUscf2Oqi2WrjuV6uBL1qQF4ij532kfK6%2F9CUFiR8WCcJTRRUY8tXiFEwvIqZgmtIVFwvM0LYQen6QCvLnKTUp0AMc2ymHLKsE0HZf1NliVykQNTLFs16Jtb7B2jfwAcWSJyerP%2FLOjKzBSfI%2FZ2rWeG9kP0Z18hdBlftnUDPcPWtG%2F5Q1wzXc%2F1ko9sDwDN1UGn2s2sJkSorfMBZcSEQSkRRyPzDONyDKWZhg6COHmFbkssgKhofme90QsyBYeWVbTrX9c4C0IsONGuS4Rlp5W7KKvFZWjfYvQdmCxZwmXVwduP64Voso1zXrj2NtYWoNHv6McwyuMlA%2FMiXSFD2y27P7e1FCxp7oz9VUhfNSwRK12o972XMnxVxYqrKyar0kHfZSptsonXJtqGUTU63RMW1tmxeSQivAa7Zp7H9KKa%2Bt1MgUanBUoaytQpXhf6EaBfDUQhFDqN1X%2FKMeGfaozRjZcmU99pHhme7GS5l6684uzdKp1GCntd2jWntgqDQFvPed2RXoDPzsmNW6%2Bpv11h09%2BJuKtWNef6Z%2BBMGcn9rUm0X6DO71jvkbJusk643ZeodarrvL1sPD2BrD%2Bvfyqq3xk55c%2FQE%3D%3C%2Fdiagram%3E%3Cdiagram%20id%3D%22dfIvOOW6uf5FMUzMlSmy%22%20name%3D%22Page-3%22%3E5VrLcpswFP0az6SLdngYbC9rnDSLpJ0m7fSxyahGASWAGCFiO1%2FfCwgwSNhpJ8aOvTI6CD3OuboP8MB0wuUnhmL%2Fmro4GBiauxyYs4Fh6OZwDD8ZsiqQsWYWgMeIKzrVwC15xgLUBJoSFyeNjpzSgJO4Cc5pFOE5b2CIMbpodrunQXPWGHlYAm7nKJDRH8TlvtiFMarxS0w8v5xZtyfFnRCVncVOEh%2B5dLEGmecD02GU8uIqXDo4yMgreSmeu%2Bi4Wy2M4Yi%2F6IEpir9MnWD29fHq4vnSumb%2B%2FL0QI%2BGrcsPYhf2LJmXcpx6NUHBeo1NG08jF2agatOo%2BV5TGAOoAPmDOV0JMlHIKkM%2FDQNwt5swm6tyKgBKasjnesP7SJBDzMN%2FQz6gIB0vFNMScreA5hgPEyVNzHUiYjFf1q1mFC0HsP5Asxn1CQSpmusXAIAPsAs05ZQQsvK1DzXJG2cInHN%2FGKCdjAUdNxegTZhwvN3Mqc1A%2BMBR2Kg5q2VzUVq%2BXpuyvWbyt7Yg1Q2LtIU34wfGk2%2Fsmaqgk6i4pbWxg2CjMiAhgJdNvVdPjFSNrfCYLEgYowr2QObSbZJoyl4am4LICX51MSyIzgQOKK6hNF%2BydN2lBAfEiuJ4DB8C%2FOc0YIhBRPoobIXHdwpHihDyjP%2FlQmSuNKYl4viFrOrBm2VjgO5PCjWZDJ5zRR%2BzQgMK4s4jmKt2TIGhBL1Om05Y65WqpZVmSWmOFWOautLIlre7BlUbuWjpw0nJZLU%2BlKzyV6nTtTLCRJFilU8tL3bS9lHbWcGowv3bz7sCc1%2F69V6nwGsMM85RFgNEYM0h2aJRThvjR%2B7LRRvXM9uGQnVkV6ns5HGNJOo4ecZ6kzjHkqOy09SqDjdDLluWa9KmWrktyvK3KSQTPrZVThyo9VU5yEaBwY3LscA46y7WN%2FQcKUyI2z3OTOtF1Tsj16B3vB9SxQpH39hsqdLnkqzJfOBPs6PPeLXrZ22N7r4VKOX%2B%2FwQIoZKuf2fMfrLL5SwyXN2bLRmslWq8YZMp8dGuU6RK0pzAjV5LiGDXKjgOrN8bjyd7DyOhUDXv4UsO292rYclGRYH6XN8%2Fq4O6UXWQLf8OBY%2FNhGjcP08RUBHV7R0Ei0RIn9cfk8%2BQu%2Fc5HxJt9%2Ba34SnDTlX316naqV0R7ec2hpEquCur0B8wbMtk4BgdzPLbcbTDdOWuzXtYVqik%2FU%2BzMvuWKoyEaZoweU53xH5INm5JNFIrt6nWtcrWbqowyipy4Yq3CUKGY%2FjqKQbP%2Bq0B%2Bb%2B0PF%2Bb5Xw%3D%3D%3C%2Fdiagram%3E%3Cdiagram%20id%3D%22zS0qvL6dZnKoQc5eDSts%22%20name%3D%22Page-4%22%3E5Vpbc%2BI2FP41zKQP3fEdeFwgadN2p%2BkynSRPGS0W4MRYriwC5Nf3yJZtZAkDGwwJPIGOj2zr%2B3Sucsvuz5a%2FURRPvxEfhy3L8Jcte9CyLNN2OvDDJatM0jHsTDChgS%2BUSsEweMNCaAjpPPBxIikyQkIWxLJwRKIIj5gkQ5SShaw2JqH81BhNsCIYjlCoSu8Dn03FKqx2Kf8dB5Np%2FmTT62ZXZihXFitJpsgnizWRfd2y%2B5QQlv2bLfs45ODluGTzbjZcLV6M4ojtMuHh8Xn%2B9%2F3SuOs9P%2F35z%2Bs3cvvH26%2BCjFcUzsWCxcuyVY4A9gEQMSSUTcmERCi8LqU9SuaRj%2FljDBiVOn8REoPQBOEzZmwl2EVzRkA0ZbNQXM2eyR%2B0cW1ClJA5HeGaBeV7BNEJZjV6VsEAbF1MZpjRFcyjOEQseJXfA4k9NCn0Spjhj0B6D9RNBfX%2BFAURiBaEvigMlPhysBbTgOFhjFIYFmB1OixfMWV4WY%2BmunoxId%2BxwmQdMVyU%2B9%2FMVaZre98zGoLLUuBiUxwpMG0BRkbx8DCZnVPj5G7AyUMzjkUIz%2B8NWxbc3LgppBOWomFcJRjgoXB5PI9GLCDRLwrCySKYhSjC23dhAgbIhL3bxmHwLlxrDrihAm4ZGsAL4eEN2T6FuwS86OqBz%2F%2Fi5sNHcbt0MFhKo5UYHdDNeju62fYp3ayn2APFbE6jhL85WMZTvuUrFMIWZTLiKAwmEfwfAVAwwe7xjRxAlvBVXJgFvp%2BRi5PgDf1Ib8Uxj0kQsXRhbq%2FlDvi9gM8kozazFEpecJ%2BEBO47iEhqXeMgDCuigzgsRzYg11U9lq0xILsp%2B2lrPVbByy6O66ddVAMeyW6f3CN1FUTHNAA411Lk89nu%2B7gccRe3ErQ1McTUMdaYCXQUwoaMAKwgG%2BYRme97EZTPiL0tttWVnZVjapyVe0ymTDVtL0zKkJ3VdzW9khwbZ%2FT7e%2FKrBpyXp8nzj51Offbqs7tjWmRuoOZI5WfnFDCvZa3OXmlrOrrDNIDVc3926FzWdHZlzT0pa47ifirpLIkxRZcVJDqyD2vrgoRz1CChL8LXuTG0iS2EjP6HTm67Ry23Bw%2FD%2F95eZrf3j0%2FP9v2%2FRmzf3OYNjk8bHkxN2axd6HvDQzr1K6VotaYgDLe88x0XlIQ7RoXwbqWhvEXfM%2Bv1Xdep04c%2F2RuX%2B6NY%2BjvsUW0CJHl%2BvW6TCUMMX47f7Faobp%2Fcb6qtgKJwTZuJF8MNkCNxYxqaoNZpiJvN3kiiZrvlHDVUOc4OpYx51FBlqWnAKsY8%2BPOBl0b%2BH7zFlUZ6UUeWPfg0Z6B4hMHbU7VQ%2FLx7f59wl8cNmVtNw6arodZpiln1yFQiS2kEfKysrmoqHyCrU%2Bua0vNj9pTJz9wC7HrSZBNwNMFa590aCwhqz1JiDBKsOIaU%2B7I5qzSaTY3f0p0ON0ZaXYIFpGFKAZaLpqxyNqA7z2%2FqaED7tupZTlq6pIVgHmx462B8fmcDBzA43eFmUyWN9nU9hY8P262oS2G3Nis20HLwrqg%2BdTRUI9mYNPzc9yuWfajUS96h%2BtNi95ipV37gsn6khfi0aoFSYHq15nq437lKpVChGOdfpRi19La%2FyFmaht3jFir5eeU5f5xUV1Bs77JuILTZNmu7I7uBrlffNq3q2%2B6WNmvVzcj6%2B7ZZYVh%2Bo5ypl19629f%2FAw%3D%3D%3C%2Fdiagram%3E%3Cdiagram%20id%3D%22N1fN19OSE8Ezd9pb87vr%22%20name%3D%22Page-5%22%3E7VvRbqM4FP0apO5DKzABkscm7XRWsytVk0ozOy%2BRA07iHYIZY5pkvn5tcEKwTWi7DRklI1URvhgD59x7fH1NLXe0XD9QmC7%2BJhGKLWBHa8u9swAIPI%2F%2FCsNGGgZ%2BaZhTHJUmpzKM8U8kjba05jhCWa0jIyRmOK0bQ5IkKGQ1G6SUrOrdZiSu3zWFc6QZxiGMdesXHLFFae2DoLJ%2FRHi%2B2N7Z8QflmSXcdpZvki1gRFZ7JvfeckeUEFYeLdcjFAvstriU131oOLt7MIoS9pILso%2Ff%2Bt%2B8py%2BD9e0mmz4l9M%2FVj2s5yjOMc%2FnC2SYJJyuImQV8uEwtdxjz4YfjXXMumlcZSiJE%2F5CvxjZbvLIVXsYw4a3haoEZGqcwFKdW3Du4bcGWMW85%2FFDeGVGG1o2v5OyA4g6GyBIxuuFd5AXAk9hK5wKubK8qqkBf2hZ7NAFfGqF0j%2Flu7ApBfiBBfAWgQAOUIpbTJOP4FUBOKT8qMCQpwySBcR3oEtgJRVkes8lhFtSWwgUHltUxhzGeJ%2Fw45AAjyg0Cfsy9%2FVaeWOIoEpcP%2Bf3xTzgthrJ5OyU4YQVY3tDy7sRYOSNZGa9i6IxR8h2NSEz4uHcJKVxghuNYMb2I9mZfbfQF1RUc3RUckyv03sETPj0MJ4%2Fws%2F%2Fp6WHqXvuf8yeQHQ4tO4IMXjZh%2FTphhtB1bANf7tH40kN3O6lwkoqoLCYfS%2BisGss7annghgg%2Fi75qn3ooG8Z4XeQ3jf5bC4Dv1VzLM7iWa3CtwbFcC%2Fi6FjBIhWORFFEo5oHLZiwY1BhzTq4GoK9Rlif4R44mMQm%2F6%2BEXPt%2BI8L8qz46ESHhVTJa%2FAvlgWOYDcgq4iSSuwZ2eS12UB4Be3QN8QyrndDl%2F69NBJfLG2bvT1Nd16nh5BpEDpojZGd8dsJ4G2DIXL3g%2Bbt3sJ83CZis0aSz5XcqaZ8pxIrxdiPATFBfwXjRpbj1%2F6L8wfzgaa3r6MCUkRvCckoY30KSkeY5hyRd0SVOg0YTWIUrPLLt7B6IMc1WnRLkaHSiao7FsEsoWZC4E8b6yDinJ%2BfIskpBXff4iJJUw%2F4sY28gSpmDANOmLGx2e8vlzkZyG6MDzbwuhkM7RG1ihKOZLjuf6c5hALi69pRRu9jpIb6tGfhSGvUTOrk95IPD2CWvt73u2QnD5BBXdu1d5uwfo2f3rVt%2BnTP28gQJw7%2BSp30CDs8LRJrP9Akpx2h5b7i3%2FY2ekiy0lCaeuga4hE9zpYjf1LkcDvwMV5HDRzVdx%2FY3H0yxp%2BKcw2PbOcLeWtyhbm%2F3WI6KYQyB8oTC%2BTVgPVe9bhbV%2FCmH1lBJ3L1A2fFr6b12pqb8%2FCA71P44QO66uxKZa6p4YP%2F1KYuzb6gLPJMZel2Ls6Iu8jBGKCgedIf5moTguKtnVHpTsfj56fMDdGtlURNo3aPSgU43W85QZxXwqLWZUNkGUclwumzNF5UyLi443kvR14G%2FSWkgDJydNr142imZIeBpCxJDTstx%2FNlS2zXXKvlr%2F1PoIPA38jnPYWgbbkr1a71gBkCXB9hKAbab0xanq%2F4sqvXJZk8Jzyzla4qenpBc9Q%2FyY9riOFz%2B2rnpbWq6q7HtUxEDR7cRffHmD4EYtzp884d6%2BhrZXzG1nNkG8SmN269AaYYZqlem7rOP5PNDYKg5vKEpj7rpXRi%2B%2FLMoUoQoM2RnolDNDlQAVn9EJIGRaxuhZzSVv4k1Jqw3a2PEEo6fVCWF4tqm4W2H%2BaEVSfYn70If5vG7fODN%2BFHO8nTNbY%2BRCEu6XloabFr7HrQ27yte0XkutN7DdQ%2F1fW%2BvlzeofGcru1X%2BDuPf%2FAQ%3D%3D%3C%2Fdiagram%3E%3C%2Fmxfile%3E" target="_blank" rel="noopener noreferrer">these diagrams</a>.</li></ul></li><li><p>Futures</p><ul><li>One of the points of S/R is to avoid the allocations associated with futures, also, futures are single-use, whereas S/R, in general, can be used (started) multiple times. - Dr. H. Kaiser</li></ul></li></ul><p>Goal is to enable all Sender CPOs to do the following:</p><ul><li>If we write a sender and pass it to a function which could be a coroutine that could co_await that sender and get its result.</li><li>If they are not generally awaitable then we can await transform them (i.e. make them awaitable).</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-more-context-on">6. More Context on:<a class="hash-link" href="#6-more-context-on" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-coroutines">6.1. Coroutines<a class="hash-link" href="#61-coroutines" title="Direct link to heading">​</a></h3><p>Quoting from the below references:</p><ul><li>Some senders are awaitables</li><li>All awaitables are senders</li><li>When the coroutine is in a suspended state it basically becomes a callback function but we know callbacks are straightforward receivers, then coroutines are receivers and awaitables are senders.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="62-senders-and-receivers">6.2. Senders and Receivers<a class="hash-link" href="#62-senders-and-receivers" title="Direct link to heading">​</a></h3><ul><li>Senders are just a lazy value</li><li>Receivers are like callbacks which provide 3 slots<ul><li>set_value</li><li>set_error</li><li>set_stopped</li></ul></li><li>The relationship between these two is that the sender passes the values to the receiver which has 3 specific slots to report to.</li><li>A Scheduler is a handle where these computations will be performed. These produce senders which maybe accepted by the async algorithms.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-work">7. Work<a class="hash-link" href="#7-work" title="Direct link to heading">​</a></h2><p>My PRs can be found using <a href="https://github.com/STEllAR-GROUP/hpx/pulls?q=is%3Apr+author%3ASAtacker" target="_blank" rel="noopener noreferrer">this</a> link as it&#x27;ll always be updated.</p><p>Following are the Merged PRs until now:</p><p>Minor Improvements:</p><ul><li><a href="https://github.com/STEllAR-GROUP/hpx/pull/5846" target="_blank" rel="noopener noreferrer">[execution] Add schedule_result_t alias template</a><ul><li>This was a warm-up PR to ensure that I can read the standard reference implementation and can write tests that are necessary.</li></ul></li><li><a href="https://github.com/STEllAR-GROUP/hpx/pull/5865" target="_blank" rel="noopener noreferrer">[hpx::execution] Added forwarding_scheduler_query</a><ul><li>I revised a lot of tag_* mathods especially <a href="https://www.open-std.org/jtc1/sc22/WG21/docs/papers/2019/p1895r0.pdf" target="_blank" rel="noopener noreferrer">tag_invoke</a>. </li><li>Found minor bug in the implementation for it and fixed it <a href="https://github.com/STEllAR-GROUP/hpx/pull/5865/files#diff-c220d96705c8982a255599928a8fce5d89c4d0b54344d7357177bd8c22f5f67f" target="_blank" rel="noopener noreferrer">link</a></li><li>As far as the tests went it was pretty clear that we need to test the CPO using a custo implementation</li></ul></li><li><a href="https://github.com/STEllAR-GROUP/hpx/pull/5920" target="_blank" rel="noopener noreferrer">[P2300] enhancements: receiver_of, sender_of improvements</a><ul><li>A good revision of SFINAE helped me implement the following metafunctions
<code>is_invocable_variant_of_tuples</code>, <code>is_invocable_variant</code></li><li>Added <code>sender_of</code> concept that defines the requirements for a sender type that on successful completion sends the specified set of value types.</li><li>Added <code>receiver_of</code> concept takes a receiver and an instance of the <code>completion_signatures&lt;&gt;</code> class template.</li><li>Tons of tests for all the above.</li></ul></li><li><a href="https://github.com/STEllAR-GROUP/hpx/pull/5945" target="_blank" rel="noopener noreferrer">[P2300] Added fundamental coroutine_traits for S/R</a><ul><li>Firstly I had to modify the C++ compiler check for C++ 20 Coroutines functionality.</li><li>This led to an addition of a new <code>hpx/config/coroutines_support.hpp</code> header.</li><li>An awaiter concept - An Awaiter type is a type that implements the three special methods that are called as part of a co_await expression: await_ready, await_suspend and await_resume.</li><li>An awaitable concept - Something that you can apply the ‘co_await’ operator to. If the promise type defines an await_transform() member then the awaitable is obtained by calling <code>promise.await_transform(value)</code>, passing the awaited value. Simply checks whether the type supports applying the co_await operator to avalue of that type. If the object has either a member or non-member operator co_await() then its return value must satisfy the Awaiter concept. Otherwise, the Awaitable object must satisfy the Awaiter concept itself.</li><li>Tons of tests as usual</li></ul></li></ul><p>Major Work:</p><ol><li>Adapt <code>get_completion_signatures</code> when Sender is a awaitable
This confused me for a while actually. There was a minor bug in the P2300 5th Rev Specification. It did not consider the environment for awaitables i.e. it did not consider the promise type for awaitables. All those awaitables whose promise type defines await_transform would not be considered awaitables and there won&#x27;t be any completion signatures for them. This led to a further discussion recently with Eric Niebler. I think that it will be revised even further. But for now we can deal with senders that expose a co_await operator.</li><li>Utility <code>as_awaitable_t</code><ul><li><code>receiver_base</code>, <code>sender_awaitable_base</code> </li><li>to transform an object into one that is awaitable within a particular coroutine.</li></ul></li><li>promise base for 5.</li><li>operation base for 5.</li><li>Utility <code>connect_awaitable</code> to adapt <code>connect</code> mentioned in <a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2300r5.html#spec-execution.senders.connect" target="_blank" rel="noopener noreferrer">spec</a> 2.2</li><li>Utility <code>with_awaitable_senders</code>  <ul><li>Used as the base class of a coroutine promise type, makes senders awaitable in that coroutine type</li></ul></li></ol><p><a href="https://github.com/STEllAR-GROUP/hpx/pull/5990" target="_blank" rel="noopener noreferrer">This</a> is the PR for the above work.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-future-work">8. Future work<a class="hash-link" href="#8-future-work" title="Direct link to heading">​</a></h2><ul><li>Test these on all the algorithms that returns a sender.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="9-extra-contribution">9. Extra Contribution<a class="hash-link" href="#9-extra-contribution" title="Direct link to heading">​</a></h2><ul><li>I discovered a bug in the standard specification of P2300 which is filed as an issue and made a PR to the reference implementation for this issue is currently in progress. <a href="https://github.com/brycelelbach/wg21_p2300_std_execution/pull/602" target="_blank" rel="noopener noreferrer">here</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="10-example-code">10. Example Code<a class="hash-link" href="#10-example-code" title="Direct link to heading">​</a></h2><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">template</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">typename</span><span class="token plain"> </span><span class="token class-name">T</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">custom_task</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">template</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">typename</span><span class="token plain"> </span><span class="token class-name">A</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">custom</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">using</span><span class="token plain"> promise_type </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> custom</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">T</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">custom_task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">custom_task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">custom_task</span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> that</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">noexcept</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">coro_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">exchange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">that</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">coro_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">~</span><span class="token function" style="color:#d73a49">custom_task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">coro_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            coro_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">destroy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">explicit</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">custom_task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hpx</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coro</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coroutine_handle</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">promise_type</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> __coro</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">noexcept</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">coro_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__coro</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">final_awaitable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">false_type </span><span class="token function" style="color:#d73a49">await_ready</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">noexcept</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> hpx</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coro</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coroutine_handle</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">await_suspend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            hpx</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coro</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coroutine_handle</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">promise_type</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> h</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">noexcept</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> h</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">continuation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">await_resume</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">noexcept</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">template</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">typename</span><span class="token plain"> </span><span class="token class-name">A</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">custom</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token base-clause">hpx</span><span class="token base-clause double-colon punctuation" style="color:#393A34">::</span><span class="token base-clause">execution</span><span class="token base-clause double-colon punctuation" style="color:#393A34">::</span><span class="token base-clause">experimental</span><span class="token base-clause double-colon punctuation" style="color:#393A34">::</span><span class="token base-clause class-name">with_awaitable_senders</span><span class="token base-clause operator" style="color:#393A34">&lt;</span><span class="token base-clause class-name">custom</span><span class="token base-clause operator" style="color:#393A34">&lt;</span><span class="token base-clause class-name">T</span><span class="token base-clause operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        custom_task </span><span class="token function" style="color:#d73a49">get_return_object</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">noexcept</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">custom_task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                hpx</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coro</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token class-name">coroutine_handle</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">promise_type</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">from_promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hpx</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coro</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">suspend_always </span><span class="token function" style="color:#d73a49">initial_suspend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">noexcept</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        final_awaitable </span><span class="token function" style="color:#d73a49">final_suspend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">noexcept</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">unhandled_exception</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">return_value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">T value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">noexcept</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            data_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">template</span><span class="token plain"> </span><span class="token generic-function function" style="color:#d73a49">emplace</span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name number" style="color:#36acaa">1</span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">variant</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">monostate</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> T</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">exception_ptr</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> data_</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        custom_task context_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">template</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">typename</span><span class="token plain"> </span><span class="token class-name">ParentPromise</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">task_awaitable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hpx</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coro</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coroutine_handle</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">promise_type</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> coro_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">optional</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">custom</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ParentPromise</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> context_</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">false_type </span><span class="token function" style="color:#d73a49">await_ready</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">noexcept</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">template</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">typename</span><span class="token plain"> </span><span class="token class-name">ParentPromise2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hpx</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coro</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coroutine_handle</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">await_suspend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            hpx</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coro</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coroutine_handle</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ParentPromise2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> parent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">noexcept</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            coro_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">set_continuation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> coro_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        T </span><span class="token function" style="color:#d73a49">await_resume</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            context_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">reset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">coro_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">rethrow_exception</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#d73a49">get</span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name number" style="color:#36acaa">2</span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">coro_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">constexpr</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">is_void_v</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">T</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#d73a49">get</span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name number" style="color:#36acaa">1</span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">move</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">coro_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">friend</span><span class="token plain"> task_awaitable</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">operator</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">co_await</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">custom_task</span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">noexcept</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> task_awaitable</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">exchange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">coro_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">template</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">typename</span><span class="token plain"> </span><span class="token class-name">ParentPromise</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">friend</span><span class="token plain"> task_awaitable</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ParentPromise</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tag_invoke</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hpx</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">execution</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">experimental</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">as_awaitable_t</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> custom_task</span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ParentPromise</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">noexcept</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> task_awaitable</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ParentPromise</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">exchange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">coro_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hpx</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coro</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">coroutine_handle</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">promise_type</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> coro_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">template</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">typename</span><span class="token plain"> </span><span class="token class-name">S1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">typename</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">enable_if_t</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">hpx</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">execution</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">experimental</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">is_sender_v</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">S1</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">custom_task</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">int</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">async_answer_custom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">S1 s1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Senders are implicitly awaitable (in this coroutine type):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">co_return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">co_await</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">S1 </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> s1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Awaitables are implicitly senders:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">auto</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> hpx</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">this_thread</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">experimental</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">sync_wait</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">async_answer_custom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hpx</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">execution</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">experimental</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">just</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;The answer is &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> hpx</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token generic-function function" style="color:#d73a49">get</span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name number" style="color:#36acaa">0</span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token char">&#x27;\n&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">exception</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">what</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token char">&#x27;\n&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="11-references">11. References<a class="hash-link" href="#11-references" title="Direct link to heading">​</a></h2><ul><li><p><a href="https://wg21.link/P2300" target="_blank" rel="noopener noreferrer">P2300</a></p></li><li><p><a href="https://github.com/brycelelbach/wg21_p2300_std_execution" target="_blank" rel="noopener noreferrer">the reference implementation</a></p></li><li><p><a href="https://github.com/facebookexperimental/libunifex" target="_blank" rel="noopener noreferrer">libunifex</a></p></li><li><p><a href="https://github.com/STEllAR-GROUP/hpx/issues/5045" target="_blank" rel="noopener noreferrer">HPX main P2300 Issue</a></p></li><li><p>Talks</p><ul><li>&quot;A Tour of C++ Executors, Part 1&quot;: <a href="https://www.youtube.com/watch?v=xLboNIf7BTg" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=xLboNIf7BTg</a></li><li>&quot;A Tour of C++ Executors, Part 2&quot;: <a href="https://www.youtube.com/watch?v=6a0zzUBUNW4" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=6a0zzUBUNW4</a></li><li>&quot;Live-coding sender/receiver&quot;: <a href="https://www.youtube.com/watch?v=xiaqNvqRB2E" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=xiaqNvqRB2E</a></li><li>&quot;A Unifying Abstraction for Async in C++&quot;: <a href="https://www.youtube.com/watch?v=tF-Nz4aRWAM" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=tF-Nz4aRWAM</a></li><li>&quot;Structured Concurrency&quot;: <a href="https://www.youtube.com/watch?v=Xq2IMOPjPs0" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=Xq2IMOPjPs0</a></li><li>&quot;Structured Networking&quot;: <a href="https://www.youtube.com/watch?v=nmQgVVQCFu4" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=nmQgVVQCFu4</a></li><li>&quot;C++ Standard Parallelism&quot;: <a href="https://www.youtube.com/watch?v=r1COmv0CdW4" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=r1COmv0CdW4</a> </li></ul></li></ul><div style="width:100%" id="comments"><div></div></div></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/g-so-c">GSoC</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/c">C++</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/hpx">HPX</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.comSAtacker/satacker.github.io/edit/main/blog/blog/2022-01-13-gsoc-2022-work.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/basic-coa"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Review of basic CoA</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/dbus-crossc"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">DBus Cross-compilation</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-gsoc-2022-report" class="table-of-contents__link toc-highlight">1. GSoC 2022 Report</a></li><li><a href="#2-about-the-project" class="table-of-contents__link toc-highlight">2. About the project</a></li><li><a href="#3-objective" class="table-of-contents__link toc-highlight">3. Objective</a></li><li><a href="#4-abstract" class="table-of-contents__link toc-highlight">4. Abstract</a></li><li><a href="#5-brief-summary" class="table-of-contents__link toc-highlight">5. Brief Summary</a></li><li><a href="#6-more-context-on" class="table-of-contents__link toc-highlight">6. More Context on:</a><ul><li><a href="#61-coroutines" class="table-of-contents__link toc-highlight">6.1. Coroutines</a></li><li><a href="#62-senders-and-receivers" class="table-of-contents__link toc-highlight">6.2. Senders and Receivers</a></li></ul></li><li><a href="#7-work" class="table-of-contents__link toc-highlight">7. Work</a></li><li><a href="#8-future-work" class="table-of-contents__link toc-highlight">8. Future work</a></li><li><a href="#9-extra-contribution" class="table-of-contents__link toc-highlight">9. Extra Contribution</a></li><li><a href="#10-example-code" class="table-of-contents__link toc-highlight">10. Example Code</a></li><li><a href="#11-references" class="table-of-contents__link toc-highlight">11. References</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Notes</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Intro</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/SAtacker" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Follow me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://linkedin.com/in/atreshreyas" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/shreyasOO7?s=08" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://instagram.com/atre.shreyas" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2a141806.js"></script>
<script src="/assets/js/main.4858563c.js"></script>
</body>
</html>